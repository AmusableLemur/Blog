box: wercker/default
build:
    steps:
        - arjen/hugo-build:
            version: "0.14"
deploy:
    steps:
        - add-to-known_hosts:
            hostname: ssh.rasmuslarsson.se
        - mktemp:
            envvar: PRIVATEKEY_PATH
        - create-file:
            name: write key
            filename: $PRIVATEKEY_PATH
            content: $PRODUCTION_PRIVATE
            overwrite: true
            hide-from-log: true
        - script:
            name: clear
            code: ssh -i $PRIVATEKEY_PATH -l rasmuslarsson.se -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no ssh.rasmuslarsson.se rm -rf /www/*
        - script:
            name: upload
            code: scp -r -i $PRIVATEKEY_PATH public/* rasmuslarsson.se@ssh.rasmuslarsson.se:/www
